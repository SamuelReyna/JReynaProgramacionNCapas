<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

    <head>

        <title>Tabla de Usuarios</title>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <script
            src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-ndDqU0Gzau9qJ1lfW4pNLlhNTkCfHzAVBReH9diLvGRem5+R9g2FzA8ZGN954O5Q"
            crossorigin="anonymous"
        ></script>
        <link
            href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css"
            rel="stylesheet"
            integrity="sha384-LN+7fdVzj6u52u30Kp6M/trliBMCMKTyK833zpbD+pXdCLuTusPj697FH4R/5mcr"
            crossorigin="anonymous"
            />
        <link
            rel="stylesheet"
            href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css"
            />
        <script src="https://code.jquery.com/jquery-3.7.1.js" integrity="sha256-eKhayi8LEQwp4NKxN+CfCh+3qOVUtJn3QNZ0TciWLP4=" crossorigin="anonymous"></script>
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,300;1,300&family=Nunito+Sans:ital,opsz,wght@0,6..12,200..1000;1,6..12,200..1000&display=swap" rel="stylesheet">
    </head>
    <style>
        .cormorant-garamond {
            font-family: "Cormorant Garamond", serif;
            font-optical-sizing: auto;
            font-weight: 300;
            font-style: normal;
        }
        .nunito-sans {
            font-family: "Nunito Sans", sans-serif;
            font-optical-sizing: auto;
            font-weight: 300;
            font-style: normal;
            font-variation-settings:
                "wdth" 100,
                "YTLC" 500;
        }
    </style>

    <body class="bg-primary-subtle">
        <div class="container cormorant-garamond">
            <div class="row mt-2">
                <div class="col-6">
                    <h1 class="fst-italic font-weight-bold">Tabla de usuarios</h1>
                </div>
                <div class="col-4">
                    <div class="input-group flex-nowrap m-1">
                        <span class="input-group-text" id="addon-wrapping">
                            <i class="bi bi-search"></i>
                        </span>
                        <input type="text" class="form-control" placeholder="Buscar" aria-label="buscar" aria-describedby="addon-wrapping">
                    </div>
                </div>
                <div class="col-2">
                    <a class="btn text-bg-success m-1"  >
                        <i class="bi bi-arrow-clockwise"></i>
                    </a>

                    <!--data-bs-target="#AddUser"
                                            data-bs-toggle="modal"
                    -->
                    <a
                        th:href="@{/usuario/form?(IdUsuario=0, IdDireccion=0)}"
                        class="btn text-bg-primary m-1"
                        >
                        <i class="bi bi-plus-circle-fill"></i>
                    </a>

                </div>
            </div>

            <div class="row mt-3">
                <div class="table-responsive ">
                    <table
                        class="table table-light table-hover table-bordered align-middle text-center rounded shadow mb-2"
                        >
                        <thead class="table-dark">
                            <tr>
                                <th scope="col">Acciones</th>
                                <th scope="col">Nombre</th>
                                <th scope="col">Username</th>
                                <th scope="col">Datos de contacto</th>
                                <th scope="col">Datos personales</th>
                                <th scope="col">Rol</th>
                                <th scope="col">Direcciones</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr
                                th:if="${usuarios.size() > 0}"
                                th:each="usuario : ${usuarios}"
                                >
                                <td>
                                    <div class="d-flex justify-content-center gap-2">
                                        <a
                                            th:href="@{/usuario/form?(IdUsuario=${usuario.idUser}, IdDireccion=0)}"                                            class="btn btn-warning btn-sm"
                                            title="Editar"
                                            >
                                            <i class="bi bi-pencil-fill"></i>
                                        </a>
                                        <a
                                            th:href="@{/usuario/usuarioDelete/{idUser}(idUser=${usuario.idUser})}"
                                            class="btn btn-danger btn-sm"
                                            title="Eliminar"
                                            >
                                            <i class="bi bi-trash-fill"></i>
                                        </a>
                                    </div>
                                </td>
                                <td class="text-center">
                                    <div class="d-flex flex-column align-items-center">
                                        <img th:src="|${(usuario.Img != null) ? 'data:image/jpeg;base64,' + usuario.Img : 'https://www.pngmart.com/files/23/Profile-PNG-Photo.png'}|"
                                             class="rounded-circle img-fluid mb-2"
                                             style="width: 120px; height: 120px; object-fit: cover;"
                                             alt="Foto de perfil">
                                        <span th:text="|${usuario.NombreUsuario} ${usuario.ApellidoPaterno} ${usuario.ApellidoMaterno ?: ''}|"></span>
                                    </div>
                                </td>

                                <td th:text="${usuario.Username}"></td>
                                <td>
                                    <p>
                                        <strong>Email:</strong>
                                        <span th:text="${usuario.Email}"></span>
                                    </p>
                                    <p>
                                        <strong>Tel.:</strong>
                                        <span th:text="${usuario.Telefono}"></span>
                                    </p>
                                    <p>
                                        <strong>Cel.:</strong>
                                        <span th:text="${usuario.Celular}"></span>
                                    </p>
                                </td>
                                <td>
                                    <p>
                                        <strong>CURP:</strong>
                                        <span class="nunito-sans text-uppercase" th:text="${usuario.Curp}"></span>
                                    </p>
                                    <p>
                                        <strong>Fecha Nac.:</strong>
                                        <span th:text="${usuario.FechaNacimiento}"></span>
                                    </p>
                                    <p>
                                        <strong>Sexo:</strong>
                                        <span
                                            th:text="${usuario.Sexo != 'M' ? 'Femenino' : 'Masculino'}"
                                            ></span>
                                    </p>
                                </td>
                                <td th:text="${usuario.Rol.NombreRol}"></td>
                                <td>
                                    <div th:if="${usuario.direcciones.size() > 0}">
                                        <div
                                            th:each="direccion : ${usuario.direcciones}"
                                            class="mb-2 border-bottom pb-2"
                                            >
                                            <p>
                                                <strong>Calle:</strong>
                                                <span th:text="${direccion.Calle}"></span>
                                            </p>
                                            <p>
                                                <strong>Num. Int:</strong>
                                                <span th:text="${direccion.NumeroInterior}"></span>
                                            </p>
                                            <p>
                                                <strong>Num. Ext:</strong>
                                                <span th:text="${direccion.NumeroExterior}"></span>
                                            </p>
                                            <p>
                                                <strong>Colonia:</strong>
                                                <span th:text="${direccion.colonia.Nombre}"></span>
                                            </p>
                                            <p>
                                                <strong>Ubicaci√≥n:</strong>
                                                <span
                                                    th:text="${direccion.colonia.municipio.Nombre}"
                                                    ></span
                                                >,
                                                <span
                                                    th:text="${direccion.colonia.municipio.estado.Nombre}"
                                                    ></span
                                                >,
                                                <span
                                                    th:text="${direccion.colonia.municipio.estado.pais.Nombre}"
                                                    ></span>
                                            </p>
                                        </div>
                                    </div>
                                    <div th:if="${usuario.direcciones.size() == 0}">
                                        <span class="text-muted">Sin direcciones registradas</span>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>


        </div>


    </body>
</html>
